/*
 * Description: This is test clas for apex class 
 * 
 * 
 * 
 *
  
*/
@istest
public class SalesManExercise_test {
   
     // Mock implementation for HTTP response
        private class MAN_APIMock implements HttpCalloutMock {
            public HTTPResponse respond(HTTPRequest req) {
                HttpResponse res = new HttpResponse();
                res.setStatusCode(200);
                res.setBody('{   "vin": "WMAL36ZZZ1Y076935",  "vehicleNum": "L361824",  "regNumCountryKey": "CH",  "manufacturer": "MAN",  "prodCode": "L",  "modelRange": "L20",  "modelRangeAvis": "L2000",  "vehicleType": "10.225 LLC",   "typeVariant": "LL",   "modelType": "L36",   "deliveryExWorkDate": "2001-01-03",   "firstRegDate": "2001-04-05",   "wheelBase": "4900",   "suspension": "BL",   "unitMaxWeightAllowed": "To",   "truckAxle": "03,700",   "customerRegDate": "2015-07-08",   "customerNo": "005002122",   "customerName": "Pferdesportstall Sigg AG",   "vehicleOrderNum": "804914360",   "measuringPoint": {     "measPoint": "KM-IST",     "counterReading": "108154",     "mpUnit": "KM"   },   "warranty": [     {       "type": "V",       "typeText": "Vereinbarungen allg.",       "internalNumber": "0000318",       "reasonText": "BASIS-GB. LKW IN/AUSLAND FZG  2.JAHR ANTRSTRG",       "totalMilageUnit": "KM",       "totalMilageFrom": "0000001",       "wholeMilage": "0200000",       "diffMilage": "0000000",       "diffMilage1": "0000000",       "conditionStartDate": "2002-04-05",       "conditionEndDate": "2003-04-05",       "stateOfWarranty": "A",       "text2": "Aktiv",       "text3": "SMH Startdatum MOD: 00000000  - Einlagerungstage MOD:",       "text4": "Start-KM MOD:",       "fromValue": "0000013",       "toValue": "0000024"     },     {       "type": "V",       "typeText": "Vereinbarungen allg.",       "internalNumber": "0000319",       "reasonText": "BASIS-GB. LKW IN/AUSLAND FZG  1.JAHR",       "totalMilageUnit": "KM",       "totalMilageFrom": "0000001",       "wholeMilage": "9999999",       "diffMilage": "0000000",       "diffMilage1": "0000000",       "conditionStartDate": "2001-04-05",       "conditionEndDate": "2002-04-05",       "stateOfWarranty": "A",       "text2": "Aktiv",       "text3": "SMH Startdatum MOD: 00000000  - Einlagerungstage MOD:",       "text4": "Start-KM MOD:",       "fromValue": "0000001",       "toValue": "0000012"     }   ],   "vehicleAggregate": {     "standard": [       {         "vin": "WMAL36ZZZ1Y076935",         "aggUnitDesc": "Vorderachse 1",         "aggUnitkey": "004",         "typeDescription": "V9-42L-12",         "manufSerialNo": "073081",         "manufacturer": "MAN",         "installationDate": "2001-01-03"       },       {         "vin": "WMAL36ZZZ1Y076935",         "aggUnitDesc": "Hinterachse 1",         "aggUnitkey": "006",         "typeDescription": "HY-085503",         "manufSerialNo": "488539",         "manufacturer": "MAN",         "installationDate": "2001-01-03"       }     ],     "motor": {       "vin": "WMAL36ZZZ1Y076935",       "aggUnitDesc": "Motor",       "aggUnitkey": "001",       "typeDescription": "D0836LFL02",       "manufSerialNo": "1559652521P2B1",       "manufacturer": "MAN",       "enginePower": "162",       "cubicCapacity": "06871",       "cubicCapacityUnit": "CCM",       "installationDate": "2001-01-03",       "enginePower1": "0220",       "enginePowerUnit1": "HP",       "emissionClass": "EURO3"     },     "gearbox": {       "vin": "WMAL36ZZZ1Y076935",       "aggUnitDesc": "WGetriebe",       "aggUnitkey": "003",       "typeDescription": "6S-850",       "manufSerialNo": "606314",       "installationDate": "2001-01-03",       "noGears": "6"     },     "cab": {       "vin": "WMAL36ZZZ1Y076935",       "aggUnitDesc": "Fahrerhaus",       "aggUnitkey": "008",       "typeDescription": "K",       "manufacturer": "MAN",       "installationDate": "2001-01-03",       "colour": "REINWEISS RAL 9010"     },     "steering": {       "vin": "WMAL36ZZZ1Y076935",       "aggUnitDesc": "Lenkung",       "aggUnitkey": "009",       "typeDescription": "Lenkung",       "installationDate": "2001-01-03",       "steerControl": "L"     },     "tachometer": {       "vin": "WMAL36ZZZ1Y076935",       "aggUnitDesc": "Tachometer",       "aggUnitkey": "015",       "typeDescription": "Tacho-1",       "manufSerialNo": "1",       "manufacturer": "MAN",       "installationDate": "2001-01-03"     },     "tankBody": {       "vin": "WMAL36ZZZ1Y076935",       "aggUnitDesc": "Tankaufbau",       "aggUnitkey": "307",       "typeDescription": "Tankaufbau",       "manufacturer": "MAN",       "installationDate": "2001-01-03"     }   },   "maintenance": {     "plan": [       {         "vin": "WMAL36ZZZ1Y076935",         "mpType": "3",         "salesOrg": "DE0S",         "serviceCode": "57B/G24",         "serviceCodeDesc": "TCO",         "lastMaintKM": "0 ",         "nextMaintDate": "2003-04-01",         "nextMaintKM": "0 ",         "customerRequest": {           "objectCode1": "WA1",           "objectCode2": "B",           "version": "00",           "location": "00"         }       },       {         "vin": "WMAL36ZZZ1Y076935",         "mpType": "3",         "salesOrg": "DE0S",         "serviceCode": "AU/G12",         "lastMaintKM": "0 ",         "nextMaintDate": "2002-04-01",         "nextMaintKM": "0 ",         "customerRequest": {           "objectCode1": "WA1",           "objectCode2": "C",           "objectCode3": "005",           "version": "00",           "location": "00"         }       },       {         "vin": "WMAL36ZZZ1Y076935",         "mpType": "1",         "salesOrg": "DE0S",         "serviceCode": "D08G",         "serviceCodeDesc": "4/6-ZYLINDER-DIESELMOTOR D08 GRUEN",         "lastMaintKM": "0 ",         "nextMaintKM": "0 ",         "customerRequest": {           "objectCode1": "WDA",           "objectCode2": "A",           "objectCode3": "060",           "version": "00",           "location": "00"         }       },       {         "vin": "WMAL36ZZZ1Y076935",         "mpType": "1",         "salesOrg": "DE0S",         "serviceCode": "D08R",         "serviceCodeDesc": "4/6-ZYLINDER-DIESELMOTOR D08 ROT",         "lastMaintKM": "0 ",         "nextMaintKM": "0 ",         "customerRequest": {           "objectCode1": "WDA",           "objectCode2": "A",           "objectCode3": "060",           "version": "00",           "location": "00"         }       },       {         "vin": "WMAL36ZZZ1Y076935",         "mpType": "1",         "salesOrg": "DE0S",         "serviceCode": "HS",         "serviceCodeDesc": "HANDSCHALTGETRIEBE ZF/EATON/FULLER/VW",         "lastMaintKM": "0 ",         "nextMaintKM": "0 ",         "customerRequest": {           "objectCode1": "WDA",           "objectCode2": "A",           "objectCode3": "110",           "version": "00",           "location": "00"         }       },       {         "vin": "WMAL36ZZZ1Y076935",         "salesOrg": "DE0S",         "serviceCode": "HU/G12",         "serviceCodeDesc": "HAUPTUNTERSUCHUNG",         "lastMaintKM": "0 ",         "nextMaintDate": "2002-04-01",         "nextMaintKM": "0 ",         "customerRequest": {           "objectCode1": "GA1",           "objectCode2": "A",           "objectCode3": "030",           "version": "00",           "location": "00",           "defect": "Z1"         }       },       {         "vin": "WMAL36ZZZ1Y076935",         "mpType": "1",         "salesOrg": "DE0S",         "serviceCode": "HY",         "serviceCodeDesc": "HINTERACHSE HYPOID ANGETR.",         "lastMaintKM": "0 ",         "nextMaintKM": "0 ",         "customerRequest": {           "objectCode1": "WDA",           "objectCode2": "A",           "objectCode3": "280",           "version": "00",           "location": "00"         }       },       {         "vin": "WMAL36ZZZ1Y076935",         "mpType": "3",         "salesOrg": "DE0S",         "serviceCode": "SP/G6",         "serviceCodeDesc": "SICHERHEITSPRÜFUNG",         "lastMaintKM": "0 ",         "nextMaintDate": "2001-10-01",         "nextMaintKM": "0 ",         "customerRequest": {           "objectCode1": "WA1",           "objectCode2": "A",           "objectCode3": "040",           "version": "00",           "location": "00",           "defect": "Z1"         }       },       {         "vin": "WMAL36ZZZ1Y076935",         "mpType": "0",         "salesOrg": "DE0S",         "serviceCode": "W12",         "serviceCodeDesc": "WARTUNG W12 DURCHFÜHREN",         "lastMaintKM": "0 ",         "nextMaintDate": "2002-04-01",         "nextMaintKM": "0 ",         "customerRequest": {           "objectCode1": "WD2",           "objectCode2": "B",           "objectCode3": "050",           "version": "00",           "location": "00"         }       },       {         "vin": "WMAL36ZZZ1Y076935",         "mpType": "0",         "salesOrg": "DE0S",         "serviceCode": "W6",         "serviceCodeDesc": "WARTUNG W6 DURCHFÜHREN",         "lastMaintKM": "0 ",         "nextMaintDate": "2001-10-01",         "nextMaintKM": "0 ",         "customerRequest": {           "objectCode1": "WD2",           "objectCode2": "A",           "objectCode3": "020",           "version": "00",           "location": "00"         }       },       {         "vin": "WMAL36ZZZ1Y076935",         "mpType": "2",         "salesOrg": "DE0S",         "serviceCode": "WD",         "serviceCodeDesc": "WINTERDIENST (IN DER KALTEN JAHRESZEIT)",         "lastMaintKM": "0 ",         "nextMaintDate": "2002-04-01",         "nextMaintKM": "0 ",         "customerRequest": {           "objectCode1": "WD2",           "objectCode2": "A",           "objectCode3": "100",           "version": "00",           "location": "00"         }       }     ]   } }');
                return res;
            }
        }
        
        @isTest
        static void testMakeCallout() {
           
            Test.setMock(HttpCalloutMock.class, new MAN_APIMock());
            
            Test.startTest();
             	 list<id> testRecordIds=new list<id>();
			
                 Account accountRecord=new Account();
            	   accountRecord.name='test account';
            	  insert accountRecord;
             
                 Asset assetRecord=new asset();
					assetRecord.name='Mock Test Asset Record' ;
            		assetRecord.AccountId=accountRecord.id ;
                 insert  assetRecord;

                testRecordIds.add(assetRecord.id);
          		 futureAPIcallout(testRecordIds);
            Test.stopTest();
            
          
        }
    
    @future(callout=true) 
    static void futureAPIcallout(list<id> testRecordIds){
        SalesManExercise.makeApiCall(testRecordIds);
    }

}